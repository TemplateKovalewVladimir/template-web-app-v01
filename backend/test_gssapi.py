import base64
import socket

import gssapi

token = "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"
b_token = base64.b64decode(token)

FQDN = socket.getfqdn()

name = gssapi.Name(
    "HTTP/iz2vekdev-u.aa.aliter.spb.ru"  # , gssapi.NameType.hostbased_service
)
cred = gssapi.Credentials(name=name, usage="accept")


ctx = gssapi.SecurityContext(creds=cred)  # , usage="accept")
b_output_token = ctx.step(b_token)

output_token = base64.b64encode(b_output_token)

if ctx.complete:
    print("Token validated successfully!")
else:
    print("Token validation failed!")
